import flatten from "lodash.flatten";
import uniqBy from "lodash.uniqby";

/**
 * @param {object[]} cves - Array of CVEs
 */

/**
 * Flattens a nested list of CVE vulnerabilities
 *
 * @param {cves[]} unformattedList - Nested array of CVE objects
 * @returns {cves} Flattened and unique list of CVE objects
 */
export default function formatCveList(unformattedList) {
  return uniqBy(
    flatten(unformattedList).map(({cve}) => cve),
    "id",
  );
}
