/**
 * @param {object} cveWeaknessDescription - CVE weakness description which contains a CWE ID
 * @param {string} cveWeaknessDescription.value - CWE ID
 *
 * @param {object} cveWeakness - CVE weaknesses
 * @param {cveWeaknessDescription[]} cveWeakness.description - CVE weakness descriptions
 *
 * @param {object} cve - CVE object
 * @param {string} cves.id - CVE ID
 * @param {cveWeakness[]} cves.weakness - Array of CVE weakbesses
 */

/**
 * A function which returns a lits of all Memory vulnerable CVEs given a listy of CWE IDs
 *
 * @param {cve[]} cves - List of CVE objects
 * @param {string[]} memoryVulnerableCwes - List of CWE IDs which relate to memory vulnerabilities
 * @returns {object[]} Filtered list of CVEs which relate to memory vulnerabilities
 */
export default function memoryVulnerabilities(cves, memoryVulnerableCwes) {
  return cves.filter(({ weaknesses }) => {
    return weaknesses.find(({ description }) => {
      return description.find(({ value }) =>
        memoryVulnerableCwes.find(
          (element) => element === value.replace("CWE-", "")
        )
      );
    });
  });
}
