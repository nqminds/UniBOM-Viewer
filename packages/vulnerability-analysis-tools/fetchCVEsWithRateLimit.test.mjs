import { fetchCVEsWithRateLimit } from "./src/list-vulnerabilities.mjs";
import { describe, test, expect } from "@jest/globals";

describe("fetchCVEsWithRateLimit", () => {
  test("should return an object with array values", async () => {
    const data = await fetchCVEsWithRateLimit("../input/sbom.json");

    // Check if data is an object
    expect(typeof data).toBe("object");
    expect(Array.isArray(data)).toBe(false);

    // eslint-disable-next-line no-unused-vars
    for (const [key, value] of Object.entries(data)) {
      // Check if the value is an array
      expect(Array.isArray(value)).toBe(true);
    }
  });
});
