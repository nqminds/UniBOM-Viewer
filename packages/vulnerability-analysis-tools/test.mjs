// test.mjs
import { fetchCVEsWithRateLimit } from "./src/list-vulnerabilities.mjs";

async function testGetCveData() {
  const data = await fetchCVEsWithRateLimit();

  // Check if data is an object
  if (typeof data !== "object" || Array.isArray(data)) {
    throw new Error("Fetched data is not an object.");
  }

  for (const [key, value] of Object.entries(data)) {
    // Check if the value is an array
    if (!Array.isArray(value)) {
      throw new Error(`Value for key ${key} is not an array.`);
    }

    // Optional: Check if the array contains strings in the format "CVE-YYYY-NNNNN"
    for (const cve of value) {
      if (!/^CVE-\d{4}-\d+$/.test(cve)) {
        throw new Error(`Invalid CVE format found: ${cve}`);
      }
    }
  }
}

testGetCveData();
