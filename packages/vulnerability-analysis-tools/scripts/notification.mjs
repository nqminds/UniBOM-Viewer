/* eslint-disable no-console */
import dotenv from "dotenv";
import nodemailer from "nodemailer";
import path from "path";
import { dirname } from "path";
import { fileURLToPath } from "url";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);
dotenv.config({ path: path.resolve(__dirname, "../../../.env") });

const transporter = nodemailer.createTransport({
  host: process.env.HOST,
  port: process.env.EMAIL_SERVER_PORT,
  secure: false,
  auth: {
    user: process.env.LIVEMAIL_USER,
    pass: process.env.SUPPORT_PASSWORD,
  },
});

const mailOptions = {
  from: process.env.LIVEMAIL_USER,
  to: "ionut@nquiringminds.com", // anthony@nquiringminds.com
  subject: "cyber app",
  text: "The Cyber application has either restarted or is currently experiencing downtime./n Do Not Reply",
};

function sendEmail() {
  transporter.sendMail(mailOptions, (error, info) => {
    if (error) {
      console.error("Error sending email:", error);
      // Handle the error as needed, e.g., retry sending, notify admin, etc.
    } else {
      console.log("Email sent:", info.response);
    }
  });
}

try {
  sendEmail();
} catch (error) {
  console.error("Exception caught:", error);
}
