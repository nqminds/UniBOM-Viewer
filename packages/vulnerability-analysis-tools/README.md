# Vulnerability analisys tools

## These methods may change as the project progresses.

1. ### Please create the following directories in the vulnerability-analisis-tools module:
   - Input/reports
   - Input/sboms
   - Input directory can also be downloaded from [here](https://drive.google.com/file/d/1ZMkhTns-AoLhxtAgQsrHxHtBQi-69bDy/view?usp=sharing). This also contains all the (National Vulnerability Database)[NVD](https://nvd.nist.gov/) CVE/CPE data.

---

2.  #### identify_cpe.mjs/` get_cpes(filePath)` and get-syft-cpes.mjs/ `get_cpes(filePath)`
         have the same functionality of parsing an SBOM and returning a list of CPEs in the following format:
        ['cpe:2.3:a:remapping:remapping:2.2.1:*:*:*:*:*:*:*',
        'cpe:2.3:a:code-frame:code-frame:7.12.11:*:*:*:*:*:*:*',
        ...]
    These methods may become obsolete if we choose to use the methodology outlined below:
    ![Example Image](./images/complete_system.png)
    [Syft](https://github.com/anchore/syft/tree/main)
    [Grype](https://github.com/anchore/grype/blob/main/README.md)

---

3. ### list-vulnerabilities.mjs

```javascript
    /** returns a list of CVEs based on a CPE name.*/
    export async function fetchCVEsForCPE(cpeName)

    /** For a list of CPEs reurns the coresponding CVEs of each CPE */
    export async function fetchCVEsWithRateLimit(sbomPath)

    /** As the API is limited we also save the CVE data to input/cveData.json for later use.*/
```

4. ### get-historical-cves.mjs

```javascript
     /** Returns an array of historical CVEs basedon a CVE id.*/
    export async function fetchHistoricalCVEs(cveId)
```

5. ### get-historical-cpes.mjs

```javascript
     /** Returns an array of historical CPEs basedon a CPE id.*/
    export async function fetchHistoricalCPEs(cpeId)
```

6. ### generate_sbom.mjs

```javascript
    /** directoryPath can be pointed at any of the following ecosystems
        Alpmdb
        apkdb
        binary
        cocoapods
        Conan (c,c++ package manager)
        dartlang-lock
        dotnet-deps
        dpkgdb
        elixir-mix-lock
        erlang-rebar-lock
        go-mod-file
        go-module-binary
        graalvm-native-image
        haskell
        java
        java-gradle-lockfile
        java-pom
        javascript-lock
        linux-kernel
        nix-store
        php-composer-lock
        portage
        python-index
        python-package
        rpm-db
        rpm-file
        ruby-gemfile
        rust-cargo-lock
        sbom
        Swift-package-manager
    and will create an cycloneDx json input/SBOMfile and also a input/reports/vulnerability_report_fileName */
    export function generateVulnerabilityReport(directoryPath, fileName)
```
