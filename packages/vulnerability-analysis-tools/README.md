# Vulnerability analisys tools

## These methods may change as the project progresses.

1. ### Please create the following directories in the vulnerability-analisis-tools module:
   - Input/reports
   - Input/sboms
   - Input directory can also be downloaded from [here](https://drive.google.com/file/d/1ZMkhTns-AoLhxtAgQsrHxHtBQi-69bDy/view?usp=sharing). This also contains all the (National Vulnerability Database)[NVD](https://nvd.nist.gov/) CVE/CPE data. (recommended)

---

2. ### Install [syft](https://github.com/anchore/syft/tree/main) and [grype](https://github.com/anchore/grype/blob/main/README.md) on your machine

---

3.  #### identify_cpe.mjs/` get_cpes(filePath)` and get-syft-cpes.mjs/ `get_cpes(filePath)`
         have the same functionality of parsing an SBOM and returning a list of CPEs in the following format:
        ['cpe:2.3:a:remapping:remapping:2.2.1:*:*:*:*:*:*:*',
        'cpe:2.3:a:code-frame:code-frame:7.12.11:*:*:*:*:*:*:*',
        ...]
    These methods may become obsolete if we choose to use the methodology outlined below:
    ![Example Image](./images/complete_system.png)
    [Syft](https://github.com/anchore/syft/tree/main)
    [Grype](https://github.com/anchore/grype/blob/main/README.md)

---

4. ### list-vulnerabilities.mjs

```javascript
    /** returns a list of CVEs based on a CPE name.*/
    export async function fetchCVEsForCPE(cpeName)

    /** For a list of CPEs reurns the coresponding CVEs of each CPE */
    export async function fetchCVEsWithRateLimit(sbomPath)

    /** As the API is limited we also save the CVE data to input/cveData.json for later use.*/
```

---

5. ### get-historical-cves.mjs

```javascript
     /** Returns an array of historical CVEs basedon a CVE id.*/
    export async function fetchHistoricalCVEs(cveId)
```

---

6. ### get-historical-cpes.mjs

```javascript
     /** Returns an array of historical CPEs basedon a CPE id.*/
    export async function fetchHistoricalCPEs(cpeId)
```

---

7. ### generate_sbom.mjs

```javascript
    /** directoryPath can be pointed at any of the following ecosystems
        Alpmdb
        apkdb
        binary
        cocoapods
        Conan (c,c++ package manager)
        dartlang-lock
        dotnet-deps
        dpkgdb
        elixir-mix-lock
        erlang-rebar-lock
        go-mod-file
        go-module-binary
        graalvm-native-image
        haskell
        java
        java-gradle-lockfile
        java-pom
        javascript-lock
        linux-kernel
        nix-store
        php-composer-lock
        portage
        python-index
        python-package
        rpm-db
        rpm-file
        ruby-gemfile
        rust-cargo-lock
        sbom
        Swift-package-manager
    and will create an cycloneDx json input/SBOMfile and also a input/reports/vulnerability_report_fileName */
    export function generateVulnerabilityReport(directoryPath, fileName)
```

---

8. ### get-grype-vulnerabilities.mjs

```javascript
     /** This function takes as a parameter the path to a vulnerability report file generated by grype in .*/ generateVulnerabilityReport(directoryPath, fileName)
    export function getVulnerabilities(filePath)
    /** Returns an Array of objects:  Array<{
                                             name: string;
                                             installed: string;
                                             fixedIn: string;
                                             type: string;
                                             vulnerability: string  (CVE, GHSA, ...);
                                             severity: string;
                                            },
                                            ...
                                            >*/
```

9. ### get-CWEs-info.mjs

```javascript
     /** This function takes as a parameter a list of CWEs ["CWE-476", "CWE-681"].*/
    export function getCweInfo(cwes)
    /** Returns an Array of objects:  Array<  {
                                                'CWE-ID': '476',
                                                Name: 'NULL Pointer Dereference',
                                                Description: 'A NULL pointer dereference ..',
                                                Extended_Description: 'NULL pointer dereference ...',
                                                Alternate_Terms: [ 'NPD', 'null deref', ..],
                                                Likelihood_Of_Exploit: 'Medium',
                                                Common_Consequences: [ [Object], [Object] ],
                                                Related_Weaknesses: [ [Object], [Object], [Object] ]
                                            },
                                            ...
                                            >*/
```
