/* eslint-disable no-console */
import assert from "assert";
import { getCpes } from "./src/get-syft-cpes.mjs";

async function testGetCpes() {
  const result = await getCpes("../input/cyberxbom.json");

  // Make sure that each cpe starts with cpe:2.3:a:
  const regex = /^cpe:2\.3:a:[\w\-_]+/;

  result.forEach((cpe, index) => {
    assert(
      regex.test(cpe),
      `CPE at index ${index} does not match expected format: ${cpe}`
    );
  });

  console.log("All tests passed!");
}

testGetCpes().catch(console.error);
