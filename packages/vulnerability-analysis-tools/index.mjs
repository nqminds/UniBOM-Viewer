#!/usr/bin/env node
/* eslint-disable no-console */

import { getCpes } from "./src/identify-cpe.mjs";

async function main() {
  // process the command line arguments
  const args = process.argv.slice(2); // first two entries are node path and script path

  if (args.length === 0) {
    console.error("Please provide a valid flag.");
    process.exit(1);
  }

  try {
    switch (args[0]) {
      case "-getCpes":
        if (args[1]) {
          // check if the path is provided
          const cpes = await getCpes(args[1]);
          console.log(cpes);
        } else {
          console.error("Please provide a valid path to SBOM.");
        }
        break;

      default:
        console.error(`Unknown flag: ${args[0]}`);
        break;
    }
  } catch (error) {
    throw new Error(`Error: ${error.message}`);
  }
}

main();
